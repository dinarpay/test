nmap -iL 1.txt -sU -p 5060 -vv -sV --script=sip-methods -T5 -oG - | awk -v OFS=':' '
/open/ {
  for (i=4;i<=NF;i++) {
    split($i,a,"/");
    if (a[2]=="open") print $2, a[1]
  }
}' > tcpSIP.txt

nmap -iL 1.txt -sU -p 5060,5061,5070,5069,6655,5038,5080,5062,15060,6050,6051,5063,5064,5065,5067,5068,5071,5072,5073,5076,5075,5077,5078,1020,5079,1021,1022,1023,6052,6053,6054,6055,6057,6058,6059,6061,6062,6063,6070,6064,6080,15061,15062,15070,15080,6010,5090,6000,8080,5566,9060,4002,5678,5088,30000,50600,6020,5600,5160,1025,55060,45060,25060,9090,35060,9678,7368,5081,1506,4506,4444,5506,6060,3000,2506,105,100,303,7777,26969,5187,7140 -vv -sV --script=sip-methods -T5 -oG - | awk -v OFS=':' '
/open/ {
  for (i=4;i<=NF;i++) {
    split($i,a,"/");
    if (a[2]=="open") print $2, a[1]
  }
}' > UDPALLSIP.txt


==================================================

nmap -iL ip.txt -p 5060,5061,5070,5069,6655,5038,5080,5062,15060,6050,6051,5063,5064,5065,5067,5068,5071,5072,5073,5076,5075,5077,5078,1020,5079,1021,1022,1023,6052,6053,6054,6055,6057,6058,6059,6061,6062,6063,6070,6064,6080,15061,15062,15070,15080,6010,5090,6000,8080,5566,9060,4002,5678,5088,30000,50600,6020,5600,5160,1025,55060,45060,25060,9090,35060,9678,7368,5081,1506,4506,4444,5506,6060,3000,2506,105,100,303,7777,26969,5187,7140 -vv -sV --script=sip-methods -T5 -oG - | awk -v OFS=':' '
/open/ {
  for (i=4;i<=NF;i++) {
    split($i,a,"/");
    if (a[2]=="open") print $2, a[1]
  }
}' > tcpALLSIP.txt
